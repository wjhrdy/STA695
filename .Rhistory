library(survival)
library(penalized)
setwd("C:/Users/computer1/Dropbox/UKy/Spring 2015/STA 695 Section 002")
horsedata <- read.csv("ZhouM2.csv",T)
names(horsedata)
head(horsedata)
dim(horsedata)
horsedata <- horsedata[apply(is.na(horsedata),1,sum)==0,]
dim(horsedata)
sum(is.na(horsedata))
sum(is.na(horsedata[1,]))
head(horsedata)
length(unique(horsedata[,3]))
status <- (horsedata$Rank < 6)
horsedata <- cbind(horsedata,status)
horsedata$Course <- factor(horsedata$Course)
is.factor(horsedata$Course)
a <- coxph(Surv(Rank,status)~Course
+FinalOdds+WtCarried+JWinPer+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+strata(DateValue+Raceno)
,data=horsedata)
summary(a)
summary(a)
a$coef
length(a$coef)
s1 <- 1
s2 <- 2
c(s1,s2)
vector(s1,s2)
a <- coxph(Surv(Rank,status)~factor(Course)
+FinalOdds+WtCarried+JWinPer+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+strata(DateValue+Raceno)
,data=horsedata)
summary(a)
info.cri <- function(x){
aic <- -2*x$loglik[2]+2*length(x)
bic <- -2*x$loglik[2]+2*length(x)
y <- c(aic,bic)
names(y) <- c("aic","bic")
return(y)
}
info.cri(a)
info.cri <- function(x){
aic <- -2*x$loglik[2]+2*length(x)
bic <- -2*x$loglik[2]+length(x)*log(13670)
y <- c(aic,bic)
names(y) <- c("aic","bic")
return(y)
}
info.cri(a)
View(horsedata)
cov(horsedata[,7:15])
covar <- cov(horsedata[,7:15])
covar
View(covar)
a1 <- coxph(Surv(Rank,status)~factor(Course)+strata(DateValue+Raceno)
+FinalOdds+WtCarried+JWinPer+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried+FinalOdds*JPlacePer+FinalOdds*Drawing
,data=horsedata)
info.cri(a1)
info.cri(a)
summary(a)
info.cri(a)
a$coef
summary(a)$coef
info.cri(a)
a1 <- coxph(Surv(Rank,status)~factor(Course)+strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a1)
a1 <- coxph(Surv(Rank,status)~factor(Course)+strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a1)
summary(a1)$coef
summary(a1)
a1 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a1)
info.cri(a)
summary(a1)
a1 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HPlacePer
,data=horsedata)
info.cri(a1)
a1 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a1)
a1 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a1)
summary(a1)
head(horsedata)
cov(horsedata[,c(7,8,10,11,12,13,14,15)])
a2 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+log(FinalOdds)+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a2)
summary(a2)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+log(FinalOdds)+log(WtCarried)+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a3)
View(horsedata)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+log(FinalOdds)+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+log(FinalOdds)*WtCarried
,data=horsedata)
info.cri(a3)
summary(a3)
horsedata$FinalOdds <- log(horsedata$FinalOdds)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+log(FinalOdds)*WtCarried
,data=horsedata)
info.cri(a3)
cov(horsedata[,c(7,8,10,11,12,13,14,15)])
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+log(FinalOdds)*WtCarried+WtCarried*JPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried+WtCarried*JPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
,data=horsedata)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
,data=horsedata)
info.cri(a3)
a2 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a2)
a2 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+exp(FinalOdds)+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
,data=horsedata)
info.cri(a2)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried+WtCarried*JPlacePer
,data=horsedata)
info.cri(a3)
cov(horsedata[,c(7,8,10,11,12,13,14,15)])
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried+WtCarried*JPlacePer+WtCarried*Drawing
,data=horsedata)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried+WtCarried*JPlacePer+WtCarried*Drawing
+WtCarried*HPlacePer
,data=horsedata)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried+WtCarried*JPlacePer+WtCarried*Drawing
+WtCarried*HPlacePer
+JPlacePer*TWinPer
,data=horsedata)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TWinPer+JPlacePer*TPlacePer
,data=horsedata)
info.cri(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TWinPer+JPlacePer*TPlacePer+JPlacePer*HWinPer
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer+JPlacePer*HWinPer+
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer+JPlacePer*HWinPer+
,data=horsedata)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer+JPlacePer*HWinPer
,data=horsedata)
info.cri(a3)
summary(a3)
cov(horsedata[,c(7,8,10,11,12,13,14,15)])
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer+JPlacePer*HPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
cov(horsedata[,c(7,8,10,11,12,13,14,15)])
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
cov(horsedata[,c(7,8,10,11,12,13,14,15)])
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*Drawing
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*HWinPer
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*HPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
cov(horsedata[,c(7,8,10,11,12,13,14,15)])
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*HPlacePer
+Drawing*HWinPer
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*HPlacePer
+Drawing*HWinPer+Drawing*HPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*HPlacePer
+Drawing*HPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*HPlacePer
+Drawing*HPlacePer
+HWinPer*HPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)
install.packages("EYPL")
setwd("D:/GitHub/STA695")
install.packages("RCurl")
install.packages("penalized")
summary(a3)
summary(a3)$coef
a3 <- coxph(Surv(Rank,status)~strata(DateValue+Raceno)
+FinalOdds+WtCarried+JPlacePer+TWinPer
+TPlacePer+Drawing+HWinPer+HPlacePer
+FinalOdds*WtCarried
+WtCarried*JPlacePer+WtCarried*Drawing+WtCarried*HPlacePer
+JPlacePer*TPlacePer
+TWinPer*TPlacePer+TWinPer*Drawing+TWinPer*HPlacePer
+TPlacePer*HPlacePer
+Drawing*HPlacePer
,data=horsedata)
info.cri(a3)
summary(a3)$coef
View(horsedata)
